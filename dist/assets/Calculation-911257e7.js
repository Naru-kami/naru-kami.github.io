import{r as m,a as d,j as t,T as f,s as w,A as x,C as h,J as y,K as W}from"./index-dcd44d10.js";import{u as s,a as M,M as P,I as R,W as I,C as z,S as B,d as _}from"./Main-da333585.js";import{d as j}from"./Calculate-d6cc4e77.js";import{d as D,p as $,r as v}from"./utils-ea7ddf54.js";import{B as k}from"./Button-53de17bf.js";import{P as A}from"./react-plotly-b7532820.js";import{G as u}from"./FastContext-b221ac23.js";import{T as L}from"./ResetStorage-a4231e1a.js";import"./Select-4c20bede.js";import"./Input-460d3bb2.js";import"./dividerClasses-f049dc71.js";import"./Grow-1b0ab957.js";import"./Divider-386d75cb.js";import"./NumberInput-3ae6428a.js";import"./DialogTitle-70797909.js";import"./Close-0dc4e157.js";const E=w(k)(({theme:e})=>({color:e.palette.getContrastText(x[700]),backgroundColor:x[700],"&:hover":{backgroundColor:x[900]},height:40,paddingLeft:8})),G=(e,a,i)=>{var n=new Worker(new URL("/assets/MainWorker-4dc2fdb1.js",self.location),{type:"module"});n.postMessage({char:e.char,weap:e.weap,mode:e.mode}),n.onmessage=l=>{const{data:r}=l;r.pullsResult.forEach((c,p)=>{i[p]=c}),a(c=>{var p={...c};return p.plotdataCalc.x=D(i,e.weap.enabled&&!e.char.enabled&&e.mode=="fixed"&&1||0),p.plotdataCalc.y=[...i],p}),n.terminate()}};function H(){const[e,a]=s(n=>n),i=m.useCallback(()=>{var n=e.mode=="distribution"?new Array((e.char.enabled?90*(2*e.char.goal+2-+e.char.guaranteed)-e.char.pity:0)+(e.weap.enabled?154*e.weap.goal-e.weap.pity:0)+1).fill(0):new Array(+e.char.enabled*7+ +e.weap.enabled*5).fill(0);G(e,a,n)},[e,a]);return d(E,{variant:"contained",onClick:i,disabled:!e.char.enabled&&!e.weap.enabled,children:[t(j,{}),t(f,{variant:"body1",letterSpacing:1,sx:{display:"flex",alignItems:"center",pl:1},children:t("strong",{children:"Calculate"})})]})}const J={responsive:!0,displaylogo:!1,showTips:!1,toImageButtonOptions:{format:"svg",filename:"Pull statistics"}},K={name:"",fillcolor:"#3472D540",line:{color:"#3472D5"},marker:{size:10}};function O(){const[e]=s(o=>o.plotdataCalc.x),[a]=s(o=>o.plotdataCalc.y),[i]=s(o=>o.plotdataCalc.cumulative),[n]=s(o=>o.char.enabled),[l]=s(o=>o.weap.enabled),[r]=s(o=>o.mode),[c]=M(),p=m.useMemo(()=>{var o=[...a];i&&r=="distribution"&&(o=$(o));const g=r=="distribution"?"tozeroy":"none",C=o.map(b=>v(b,4)),S=r=="distribution"?"lines":"lines+markers",T=r=="distribution"?`<b> %{x:,.0f} ${c?"Primos":"Wishes"} </b> <br> %{customdata}% <br>`:`<b> ${n?"C":"R"}%{x:,.0f} </b> <br> %{customdata}% <br>`;return{x:c&&r=="distribution"?e.map(b=>b*160):e,y:o,...K,mode:S,fill:g,customdata:C,hovertemplate:T}},[e,a,i,c]),F=m.useMemo(()=>{const o=l?[.825,5.125]:n?[-.125,6.125]:[0,0],g=l?"R":n?"C":"";return r=="fixed"?{xaxis:{title:"",mirror:!0,ticks:"outside",showline:!0,zeroline:!1,color:"#FFF",tickprefix:g,range:o,dtick:1},yaxis:{title:"",mirror:!0,ticks:"outside",showline:!0,zeroline:!1,color:"#FFF",ticksuffix:"%",range:[-1,101],rangemode:"normal"},margin:{l:55,r:35,b:70,t:35,pad:4},showlegend:!1,hovermode:"x",dragmode:matchMedia("(pointer: fine)").matches&&"zoom",hoverlabel:{bgcolor:"#181c2d"},plot_bgcolor:"#181c2d",paper_bgcolor:"#181c2d"}:{xaxis:{title:c&&r=="distribution"?"Primogems":"Wishes",mirror:!0,ticks:"outside",showline:!0,showgrid:!0,zeroline:!1,color:"#FFF"},yaxis:{title:"",mirror:!0,ticks:"outside",showline:!0,showgrid:!0,showticksuffix:"all",ticksuffix:"%",zeroline:!1,color:"#FFF",rangemode:"nonnegative"},margin:{l:55,r:35,b:70,t:35,pad:4},showlegend:!1,hovermode:"x",dragmode:matchMedia("(pointer: fine)").matches&&"zoom",hoverlabel:{bgcolor:"#181c2d"},plot_bgcolor:"#181c2d",paper_bgcolor:"#181c2d"}},[a,c]);return t(h,{elevation:2,style:{maxHeight:"620px",maxWidth:"100%",marginInline:"auto",aspectRatio:16/9},children:t(A,{data:[p],layout:F,config:J,style:{width:"100%",height:"100%"}})})}const U=w(h)(()=>({padding:8,paddingLeft:16,borderRadius:"6px"}));function q(){const[e]=s(r=>r.plotdataCalc.y),[a]=s(r=>r.char.enabled),[i]=s(r=>r.weap.enabled),n=m.useMemo(()=>{const r=+a*7+ +i*5;return e.length==r?e:new Array(r).fill(0)},[e,a,i]),l=m.useMemo(()=>({prefix:i&&"R"||a&&"C",offset:+i*1+ +a*0}),[e,a,i]);return t(h,{elevation:2,sx:{p:2,mx:"auto",mb:2,position:"relative"},children:t("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:12},children:n.map((r,c)=>t(N,{id:`${l.prefix}`+(c+l.offset),result:r},c))})})}function N({id:e,result:a}){return d(U,{elevation:4,children:[t(f,{variant:"subtitle1",fontWeight:800,children:e}),d(f,{variant:"subtitle1",fontWeight:500,children:[v(a),"%"]})]})}const Q=w(k)(({theme:e})=>({lineHeight:0,minWidth:"24px",marginLeft:"auto",padding:4,color:e.palette.getContrastText(y[700]),backgroundColor:y[700],"&:hover":{backgroundColor:y[900]},aspectRatio:"1"}));function he(){return d(u,{container:!0,spacing:2,sx:{maxWidth:"2500px"},children:[t(u,{item:!0,xs:12,children:t(P,{approach:"calculation"})}),d(u,{item:!0,sm:12,xl:4,children:[d(u,{container:!0,spacing:2,children:[t(u,{item:!0,md:6,xs:12,xl:12,children:t(R,{})}),t(u,{item:!0,md:6,xs:12,xl:12,children:t(I,{})}),t(u,{item:!0,xs:12,children:t(h,{elevation:2,sx:{p:1,color:"#FFFFFF88"},children:"Starglitter is not supported"})})]}),d(h,{elevation:2,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:1,mt:3.5,mb:1,p:1},children:[t(H,{}),t(z,{sx:{mr:"auto"}}),t(B,{})]})]}),t(u,{item:!0,xs:12,xl:8,children:t(X,{})})]})}function V(){const[e]=s(l=>l.plotdataCalc.y),[a,i]=s(l=>l.plotdataCalc.cumulative),n=m.useCallback(()=>{i(l=>{var r={...l};return r.plotdataCalc.cumulative=!r.plotdataCalc.cumulative,r})},[e]);return t("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingInline:"8px",paddingBlock:"16px"},children:t(L,{title:d(f,{variant:"body2",children:["Switch to ",a&&"density"||"cumulative"," distribution"]}),arrow:!0,placement:"top",children:t(Q,{onClick:n,"aria-label":a?"switch to PDF":"switch to CDF",children:t(_,{sx:{transform:"rotate(75deg)"}})})})})}function X(){const[e]=s(a=>a.mode);return d(W,{children:[e=="fixed"&&t(q,{}),t(O,{}),e=="distribution"&&t(V,{})]})}export{he as default};
