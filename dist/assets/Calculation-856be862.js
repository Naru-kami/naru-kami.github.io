import{r as m,a as c,j as t,T as g,s as x,p as f,F as w,P as B,C,H as b}from"./index-1cd1b434.js";import{u as s}from"./Main-b90b3d52.js";import{d as I}from"./Calculate-f7e0cf79.js";import{d as R,p as W,r as k}from"./utils-0a1c2836.js";import{B as v}from"./Button-5c9e2102.js";import{P as M}from"./react-plotly-4498cfa9.js";import{M as P,a as E,W as _,S as j,d as z}from"./Modebar-062f1d03.js";import{G as u}from"./Grid-5132b5bf.js";import{T as A}from"./ResetStorage-57376924.js";import"./FastContext-ed547aba.js";import"./Select-f4e41420.js";import"./Input-c7118c76.js";import"./Grow-863821b3.js";import"./NumberInput-80fc616e.js";import"./Close-742e01c4.js";const $=x(v)(({theme:e})=>({color:e.palette.getContrastText(f[700]),backgroundColor:f[700],"&:hover":{backgroundColor:f[900]},height:"40px"})),D=(e,a,n)=>{var i=new Worker(new URL("/naru-kami.github.io/assets/MainWorker-f8b880ca.js",self.location),{type:"module"});i.postMessage({char:e.char,weap:e.weap,mode:e.mode}),i.onmessage=l=>{const{data:r}=l;r.pullsResult.forEach((d,p)=>{n[p]=d}),a(d=>{var p={...d};return p.plotdataCalc.x=R(n,e.weap.enabled&&!e.char.enabled&&e.mode=="fixed"&&1||0),p.plotdataCalc.y=[...n],p}),i.terminate()}};function H(){const[e,a]=s(i=>i),n=m.useCallback(()=>{var i=e.mode=="distribution"?new Array((e.char.enabled?90*(2*e.char.goal+2-+e.char.guaranteed)-e.char.pity:0)+(e.weap.enabled?231*e.weap.goal-e.weap.pity:0)+1).fill(0):new Array(+e.char.enabled*7+ +e.weap.enabled*5).fill(0);D(e,a,i)},[e,a]);return c($,{variant:"contained",onClick:n,disabled:!e.char.enabled&&!e.weap.enabled,sx:{pl:1,ml:1},children:[t(I,{}),t(g,{variant:"body1",letterSpacing:1,sx:{display:"flex",alignItems:"center",pl:1},children:t("strong",{children:"Calculate"})})]})}const L={responsive:!0,displaylogo:!1,showTips:!1,toImageButtonOptions:{format:"svg",filename:"Pull statistics"}},G={name:"",fillcolor:"#1772CB33",line:{color:"#1772CB"},marker:{size:10}};function O(){const[e]=s(o=>o.plotdataCalc.x),[a]=s(o=>o.plotdataCalc.y),[n]=s(o=>o.plotdataCalc.cumulative),[i]=s(o=>o.char.enabled),[l]=s(o=>o.weap.enabled),[r]=s(o=>o.mode),d=m.useMemo(()=>{var o=[...a];n&&r=="distribution"&&(o=W(o));const h=r=="distribution"?"tozeroy":"none",y=o.map(T=>k(T,4)),F=r=="distribution"?"lines":"lines+markers",S=r=="distribution"?"<b> %{x:.0f} Pulls </b> <br> %{customdata}% <br>":`<b> ${i?"C":"R"}%{x:.0f} </b> <br> %{customdata}% <br>`;return{x:e,y:o,...G,mode:F,fill:h,customdata:y,hovertemplate:S}},[e,a,n]),p=m.useMemo(()=>{const o=l?[.825,5.125]:i?[-.125,6.125]:[0,0],h=l?"R":i?"C":"";return r=="fixed"?{xaxis:{title:"",mirror:!0,ticks:"outside",showline:!0,zeroline:!1,color:"#FFF",tickprefix:h,range:o,dtick:1},yaxis:{title:"",mirror:!0,ticks:"outside",showline:!0,zeroline:!1,color:"#FFF",ticksuffix:"%",range:[-1,101],rangemode:"normal"},margin:{l:55,r:35,b:70,t:35,pad:4},showlegend:!1,hovermode:"x",dragmode:!1,hoverlabel:{bgcolor:"#0C0F1E"},plot_bgcolor:"#0C0F1E",paper_bgcolor:"#0C0F1E"}:{xaxis:{title:"Pulls",mirror:!0,ticks:"outside",showline:!0,showgrid:!0,zeroline:!1,color:"#FFF"},yaxis:{title:"",mirror:!0,ticks:"outside",showline:!0,showgrid:!0,showticksuffix:"all",ticksuffix:"%",zeroline:!1,color:"#FFF",rangemode:"nonnegative"},margin:{l:55,r:35,b:70,t:35,pad:4},showlegend:!1,hovermode:"x",dragmode:!1,hoverlabel:{bgcolor:"#0C0F1E"},plot_bgcolor:"#0C0F1E",paper_bgcolor:"#0C0F1E"}},[a]);return t(w,{children:t(B,{variant:"outlined",sx:{background:"transparent"},children:t("div",{style:{maxHeight:"620px",maxWidth:"100%",marginInline:"auto",aspectRatio:14/9},children:t(M,{data:[d],layout:p,config:L,style:{width:"100%",height:"100%"}})})})})}const U=x(C)(()=>({padding:8,paddingLeft:16,backgroundColor:"#242734",borderRadius:"6px",backgroundImage:"none"}));function q(){const[e]=s(r=>r.plotdataCalc.y),[a]=s(r=>r.char.enabled),[n]=s(r=>r.weap.enabled),i=m.useMemo(()=>{const r=+a*7+ +n*5;return e.length==r?e:new Array(r).fill(0)},[e,a,n]),l=m.useMemo(()=>({prefix:n&&"R"||a&&"C",offset:+n*1+ +a*0}),[e,a,n]);return t(C,{sx:{p:2,bgcolor:"#1B1D2A",backgroundImage:"none",mx:"auto",mb:2,position:"relative"},children:t("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:12},children:i.map((r,d)=>t(J,{id:`${l.prefix}`+(d+l.offset),result:r},d))})})}function J({id:e,result:a}){return c(U,{children:[t(g,{variant:"subtitle1",fontWeight:800,children:e}),c(g,{variant:"subtitle1",fontWeight:500,children:[k(a),"%"]})]})}const K=x(v)(({theme:e})=>({lineHeight:0,minWidth:"24px",marginLeft:"auto",padding:4,color:e.palette.getContrastText(b[700]),backgroundColor:b[700],"&:hover":{backgroundColor:b[900]},aspectRatio:"1"}));function ue(){return c(u,{container:!0,spacing:2,sx:{maxWidth:"2500px"},children:[t(u,{item:!0,xs:12,children:t(P,{approach:"calculation"})}),c(u,{item:!0,sm:12,xl:4,children:[c(u,{container:!0,spacing:2,children:[t(u,{item:!0,md:6,xs:12,xl:12,children:t(E,{})}),t(u,{item:!0,md:6,xs:12,xl:12,children:t(_,{})}),t(u,{item:!0,xs:12,children:t(C,{sx:{p:1,backgroundImage:"none",backgroundColor:"#1B1D2A",color:"#FFFFFF88",height:"40px"},children:"Starglitter is not supported"})})]}),c("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"24px",marginBottom:"8px"},children:[t(H,{}),t(j,{})]})]}),t(u,{item:!0,xs:12,xl:8,children:t(Q,{})})]})}function N(){const[e]=s(l=>l.plotdataCalc.y),[a,n]=s(l=>l.plotdataCalc.cumulative),i=m.useCallback(()=>{n(l=>{var r={...l};return r.plotdataCalc.cumulative=!r.plotdataCalc.cumulative,r})},[e]);return t("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingInline:"8px",paddingBlock:"16px"},children:t(A,{title:c(g,{variant:"body2",children:["Switch to ",a&&"density"||"cumulative"," distribution"]}),arrow:!0,placement:"top",children:t(K,{onClick:i,children:t(z,{sx:{transform:"rotate(75deg)"}})})})})}function Q(){const[e]=s(a=>a.mode);return c(w,{children:[e=="fixed"&&t(q,{}),t(O,{}),e=="distribution"&&t(N,{})]})}export{ue as default};
