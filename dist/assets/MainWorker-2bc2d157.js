(function(){"use strict";self.onmessage=function(M){const{data:l}=M,o=performance.now(),p=l.mode=="distribution"?w(l):y(l);console.log(performance.now()-o),postMessage({pullsResult:p}),self.close()};function D(M,l){return+(M==5)&&+(l==-1)*0+ +(l>=0&&l<6)*10+ +(l!=-1&&!(l>=0&&l<6))*25||+(M==4)&&+(l==-1)*0+ +(l>=0&&l<6)*2+ +(l!=-1&&!(l>=0&&l<6))*5}function w({char:M,weap:l,starglitter:o,samplesize:p}){var s=Date.now(),x=0,n=0,f=0,t=[0];for(let i=0;i<p;i++){let a=0,e=o.count;if(M.enabled){let r=M.guaranteed,m=M.pity+1,b=1,g=0,u=0,h=0,c=0;for(;g<=M.goal;){a++,o.enabled&&e>=5&&(a--,e-=5),n=Math.min(1,.006+Math.max(0,(m-73)*.06)),f=Math.min(1,.051+Math.max(0,(b-8)*.51));let d=Math.random();d<n?(d<=n/2||r?(r=!1,e+=D(5,g+o.cons[0]),g++):(r=!0,e+=5),m=1,b++):d<f+n?(m++,b=1,o.enabled&&(d<(f+n)/3/2?(e+=D(4,u+o.cons[1]),u++):d<(f+n)/3?(e+=D(4,h+o.cons[2]),h++):d<(f+n)/2?(e+=D(4,c+o.cons[3]),c++):e+=2)):(m++,b++)}}if(l.enabled){let r=0,m=l.pity+1,b=1,g=0,u=l.guaranteed;for(;g<l.goal;){a++,o.enabled&&e>=5&&(a-=1,e-=5),n=Math.min(1,.007+Math.max(0,(m-62)*.07)),f=Math.min(1,.06+Math.max(0,(b-7)*.6));let h=Math.random();h<n?(h<=n*(u?.5:.375)||r==2?(r=0,g++,u=!1):h<=n*(u?1:.75)?(u=!1,r++):(u=!0,r++),e+=10,m=1,b++):h<f+n?(m++,b=1,e+=2):(m++,b++)}}if(t[a]==null)for(let r=t.length;r<=a;r++)t.push(0);t[a]++,i/p*100>x+1&&Date.now()-s>200&&(s=Date.now(),x=i/p*100>>0,postMessage({progress:x}))}return t}function y({char:M,weap:l,starglitter:o,samplesize:p}){var s,x,n,f,t,i,a,e,r,m,b,g=Date.now(),u=0;if(M.enabled){let h=new Array(8).fill(0);for(let c=0;c<p;c++){f=M.guaranteed,t=M.pity+1,i=1,a=0,e=o.count,r=0,m=0,b=0;for(let d=M.goal;~d+1;--d)if(o.enabled&&e>=5&&(d++,e-=5),s=Math.min(1,.006+Math.max(0,(t-73)*.06)),x=Math.min(1,.051+Math.max(0,(i-8)*.51)),n=Math.random(),n<s){if(n<=s/2||f){if(f=!1,e+=D(5,a+o.cons[0]),a++,a==7)break}else f=!0,e+=5;t=1,i++}else n<s+x?(t++,i=1,o.enabled&&(n<(x+s)/3/2?(e+=D(4,r+o.cons[1]),r++):n<(x+s)/3?(e+=D(4,m+o.cons[2]),m++):n<(x+s)/2?(e+=D(4,b+o.cons[3]),b++):e+=2)):(i++,t++);h[a]++,c/p*100>u+1&&Date.now()-g>200&&(g=Date.now(),u=c/p*100>>0,postMessage({progress:u}))}return h}else if(l.enabled){let h=new Array(6).fill(0),c;for(let d=0;d<p;d++){f=l.guaranteed,t=l.pity+1,i=1,a=0,c=0,e=o.count;for(let v=l.goal;~v+1;--v)if(o.enabled&&e>=5&&(v++,e-=5),s=Math.min(1,.007+Math.max(0,(t-62)*.07)),x=Math.min(1,.06+Math.max(0,(i-7)*.6)),n=Math.random(),n<s){if(n<=s*(f?.5:.375)||c==2){if(c=0,a++,f=!1,a==5)break}else n<=s*(f?1:.75)?(f=!1,c++):(f=!0,c++);e+=10,t=1,i++}else n<x+s?(t++,i=1,e+=2):(t++,i++);h[a]++,d/p*100>u+1&&Date.now()-g>200&&(g=Date.now(),u=d/p*100>>0,postMessage({progress:u}))}return h}return[]}})();
